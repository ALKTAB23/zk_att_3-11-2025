════════════════════════════════════════════════════════════
الإعدادات الصحيحة حسب متطلباتك
════════════════════════════════════════════════════════════

الدوام: 09:00 - 16:30
فترة السماح للدخول: 15 دقيقة (حتى 09:15)
التأخير > 8 ساعات = غياب
الإضافي: بعد 16:30 فقط (ليس قبل 09:00)

════════════════════════════════════════════════════════════
1. Attendance Policy - الإعدادات الأساسية
════════════════════════════════════════════════════════════
المسار: Attendances → Configuration → Attendance Policies → TEST 121221

Permit Check In: 15  (دقيقة - سماح حتى 09:15)
Permit Check Out: 0   (لا يوجد سماح للخروج المبكر)

════════════════════════════════════════════════════════════
2. OVERTIME RULE - قاعدة الإضافي
════════════════════════════════════════════════════════════
اضغط على "OVERTIME RULES" → "TEST 1212"

┌─────────────────────────────────────────────────────────┐
│ Name: TEST 1212                                         │
│ Type: Working Day          ← مهم جداً!                 │
│ Apply After: 00:00         ← مباشرة بعد 16:30          │
│ Rate: 2.00                 ← ضرب × 2                   │
└─────────────────────────────────────────────────────────┘

شرح:
- الإضافي يبدأ فقط بعد 16:30 (انتهاء الدوام)
- دخول قبل 09:00 لا يحسب إضافي (الكود يحسب فقط الخروج المتأخر)
- Apply After = 0.00 يعني احسب من أول دقيقة بعد 16:30

مثال:
خروج 18:30 → إضافي = (18:30 - 16:30) × 2 = 2 × 2 = 4 ساعات

════════════════════════════════════════════════════════════
3. LATE IN RULE - قاعدة التأخير
════════════════════════════════════════════════════════════
اضغط على "LATE IN RULE" → "TEST 1"

القاعدة 1: تأخير من 15 دقيقة إلى 8 ساعات
┌─────────────────────────────────────────────────────────┐
│ Name: TEST 1 - Late < 8h                                │
│ Counter: First Time                                     │
│ From Time: 0.00      ← من 0 ساعة (أي تأخير)           │
│ To Time: 8.00        ← إلى 8 ساعات                     │
│ Type: rate                                              │
│ Rate: 1.0            ← احسب كامل التأخير               │
│ Hours: 0.0                                              │
└─────────────────────────────────────────────────────────┘

شرح:
- Permit Check In = 15 يطرح تلقائياً
- دخول 09:20 → تأخير خام = 20 دقيقة
- بعد طرح Permit = 20 - 15 = 5 دقائق
- القاعدة تنطبق: 0.083h >= 0.00 AND 0.083h <= 8.00 ✓
- late_in = 0.083 × 1.0 = 0.083 ساعة

- دخول 10:00 → تأخير خام = 60 دقيقة = 1 ساعة
- بعد طرح Permit = 1 - 0.25 = 0.75 ساعة
- late_in = 0.75 × 1.0 = 0.75 ساعة

- تأخير > 8 ساعات → لا تنطبق القاعدة → يعتبر غياب

════════════════════════════════════════════════════════════
4. DIFFERENCE TIME RULE - قاعدة الخروج المبكر
════════════════════════════════════════════════════════════
اضغط على "DIFFERENCE TIME RULE" → "TEST 1"

┌─────────────────────────────────────────────────────────┐
│ Name: TEST 1                                            │
│ Counter: First Time                                     │
│ From Time: 0.00      ← من أي خروج مبكر                 │
│ To Time: 24.00       ← إلى نهاية اليوم                 │
│ Type: rate                                              │
│ Rate: 1.0            ← احسب كامل الخروج المبكر          │
│ Hours: 0.0                                              │
└─────────────────────────────────────────────────────────┘

مثال:
خروج 15:00 → خروج مبكر = 16:30 - 15:00 = 1.5 ساعة
diff_time = 1.5 × 1.0 = 1.5 ساعة

════════════════════════════════════════════════════════════
5. ABSENCE RULE - قاعدة الغياب
════════════════════════════════════════════════════════════
اضغط على "ABSENCE RULE" → "TEST 1"

┌─────────────────────────────────────────────────────────┐
│ Name: TEST 1                                            │
│ Counter: First Time                                     │
│ Rate: 1.0            ← يوم غياب كامل                   │
└─────────────────────────────────────────────────────────┘

ملاحظة:
- تأخير > 8 ساعات: النظام يعتبره غياب (ab) تلقائياً
- Late Rule لا تنطبق لأن act_late_in > 8.00

════════════════════════════════════════════════════════════
6. FORGET REGISTER RULE - قاعدة نسيان البصمة
════════════════════════════════════════════════════════════
اضغط على "FORGET REGISTER RULE" → "TEST 1"

┌─────────────────────────────────────────────────────────┐
│ Name: TEST 1                                            │
│ Counter: First Time                                     │
│ Rate: 0.5            ← خصم نصف يوم                     │
└─────────────────────────────────────────────────────────┘

════════════════════════════════════════════════════════════
ملخص الإعدادات النهائية:
════════════════════════════════════════════════════════════

✅ Permit Check In: 15 دقيقة
✅ Permit Check Out: 0 دقيقة

✅ Overtime Rule:
   Type: Working Day
   Apply After: 00:00
   Rate: 2.00
   → يحسب بعد 16:30 فقط

✅ Late In Rule:
   Counter: First Time
   From: 0.00
   To: 8.00  ← مهم! ليس 24.00
   Type: rate
   Rate: 1.0
   → تأخير <= 8 ساعات

✅ Diff Time Rule:
   Counter: First Time
   From: 0.00
   To: 24.00
   Type: rate
   Rate: 1.0

✅ Absence Rule:
   Counter: First Time
   Rate: 1.0

✅ Forget Rule:
   Counter: First Time
   Rate: 0.5

════════════════════════════════════════════════════════════
الفرق الأساسي عن الإعداد السابق:
════════════════════════════════════════════════════════════

❌ السابق: Late Rule To Time: 24.00
✅ الصحيح: Late Rule To Time: 8.00

هذا يعني:
- تأخير من 0 إلى 8 ساعات: يحسب تأخير
- تأخير > 8 ساعات: لا تنطبق Late Rule → يبقى status = "ab" (غياب)

